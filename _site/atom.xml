<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>Jingbei Li's Blog</title>
 <link href="http://jingbei.li/" rel="self"/>
 <link href="http://jingbei.li"/>
 <updated>2015-08-20T14:49:29+08:00</updated>
 <id>http://jingbei.li</id>
 <author>
   <name>Jingbei Li</name>
   <email>jingbei.li@yahoo.com</email>
 </author>

 
 <entry>
   <title>《星杯传说 破晓》的人物技能平衡调整</title>
   <link href="http://jingbei.li/2015/07/30/"/>
   <updated>2015-07-30T00:00:00+08:00</updated>
   <id>http://jingbei.li/2015/07/</id>
   <content type="html">
&lt;p&gt;《星杯传说 破晓》原版的人物平衡性就有所欠缺，在扩展包《龙族复兴》加入以后这一点就变得更为突出。
为了让这个游戏还能玩，我个人对其中的人物技能做了下述调整。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;被增强的角色：游侠 占星家 皇家侍卫 血天使 暗之王女&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;被削弱的角色：星纹师 龙之契约者 真龙女王
&lt;!--* 无调整的角色：天马骑士 圣堂刺客 炼金术士 咒术师 驱魔者 龙骑统帅 风暴执政官 剑舞者 大地武士 龙语者 幽魂法师 霜雪公主 裁决者 心灵塑师 战歌祭司--&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;进一步的调整打算：
    &lt;ul&gt;
      &lt;li&gt;buff list: 圣堂刺客 血天使 驱魔者&lt;/li&gt;
      &lt;li&gt;nerf list: 龙语者 裁决者&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section&quot;&gt;被增强的角色&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;游侠
    &lt;ul&gt;
      &lt;li&gt;【追风刺】：你的风神斩就是黯灭。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;占星家
    &lt;ul&gt;
      &lt;li&gt;增加效果：如果你的所有预兆牌都是风神斩和地裂斩，则增加一张预兆牌，可多次发动。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;皇家侍卫
    &lt;ul&gt;
      &lt;li&gt;【神圣护卫】：【当本方角色受到伤害并导致X点士气下降后发动】你分配X点治疗。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;血天使
    &lt;ul&gt;
      &lt;li&gt;【炼雷地狱】：【弃总计2张的雷系或地系牌】对一名对手造成2点法术伤害。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;暗之王女
    &lt;ul&gt;
      &lt;li&gt;增加效果：任何时候你都可以用黯灭应战。&lt;/li&gt;
      &lt;li&gt;【镇魂曲】：【攻击命中，伤害结算后发动，弃X张法术牌】对本次攻击的对手和自己各造成额外X点法术伤害。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;section-1&quot;&gt;被削弱的角色&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;星纹师
    &lt;ul&gt;
      &lt;li&gt;【命运雕刻】：指定一名不少于2张手牌的队友给你2张牌，之后将手中的2张牌交给任意一名队友，我方战绩区+1宝石。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;龙之契约者
    &lt;ul&gt;
      &lt;li&gt;【巨龙之力】：你的主动攻击伤害等于你当前手牌数量。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;真龙女王
    &lt;ul&gt;
      &lt;li&gt;移除【龙魂守护】&lt;/li&gt;
      &lt;li&gt;【真龙觉醒】：满足以下条件时，翻转任意1张“禁制”牌，在你的回合结束时，强制重新翻回所有“禁制”牌。
        &lt;ul&gt;
          &lt;li&gt;我方因收到伤害导致士气下降时&lt;/li&gt;
          &lt;li&gt;场上有星杯合成时&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;增加效果：你只能按照【龙神恩惠】【龙王神力】【百万龙炎】【圣龙威压】的顺序翻开及移除禁制。&lt;/li&gt;
      &lt;li&gt;增加效果：每发动一次【龙族复兴】，【龙族复兴】所需的宝石数量+1。&lt;/li&gt;
      &lt;li&gt;【龙王神力】：【攻击命中后弃X(X&amp;gt;1)张异系牌】本次伤害额外+X，“龙脉束缚”存在时不能发动该技能&lt;/li&gt;
      &lt;li&gt;【百万龙炎】：【弃X(X&amp;gt;1)张同系牌】对自己和任一对手各造成X点法术伤害，“龙狂迷锁”存在时不能发动该技能。&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</content>
 </entry>
 
 <entry>
   <title>The httpd.ini redirect rules for YOURLS</title>
   <link href="http://jingbei.li/2015/02/02/the-httpdini-redirect-rules-for-yourls"/>
   <updated>2015-02-02T00:00:00+08:00</updated>
   <id>http://jingbei.li/2015/02/02/the-httpdini-redirect-rules-for-yourls</id>
   <content type="html">
&lt;p&gt;The &lt;code&gt;.htaccess&lt;/code&gt; for &lt;a href=&quot;http://yourls.org/&quot;&gt;YOURLS&lt;/a&gt; will not work on Windows servers.
Although YOURLS has noticed that and will create &lt;code&gt;web.config&lt;/code&gt; automatically on Windows, my first url shortener site, &lt;a href=&quot;http://url.jingbei.li/&quot;&gt;url.jingbei.li&lt;/a&gt; still cannot redirect links as my expect.&lt;/p&gt;

&lt;p&gt;The reason is the Windows server I used is an old IIS server not a IIS7 server, the rewrite rules file should be &lt;code&gt;httpd.ini&lt;/code&gt;, not &lt;code&gt;web.config&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;And &lt;code&gt;REQUEST_FILENAME&lt;/code&gt; does not check the local files because it is relative. The current solution is writing all the file names and directory name manually to &lt;code&gt;httpd.ini&lt;/code&gt;. It is a little silly, but works.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-dosini&quot; data-lang=&quot;dosini&quot;&gt;&lt;span class=&quot;k&quot;&gt;[ISAPI_Rewrite]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/admin(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/admin$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/css(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/css$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/images(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/images$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/includes(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/includes$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/js(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/js$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/pages(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/pages$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/user(.*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/user$1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/(.*).html&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/$1.html&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/(.*).php&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/$1.php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;RewriteRule&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/.+&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;/yourls-loader.php&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;[L]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;ps&quot;&gt;PS&lt;/h4&gt;

&lt;p&gt;I’ve also resigned another domain, &lt;a href=&quot;http://pturl.tk/&quot;&gt;pturl.tk&lt;/a&gt;. It does the same things that url.jingbei.li does, but much shorter. :)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Moved to jingbei.li</title>
   <link href="http://jingbei.li/2015/01/26/moved-to-jingbeili"/>
   <updated>2015-01-26T00:00:00+08:00</updated>
   <id>http://jingbei.li/2015/01/26/moved-to-jingbeili</id>
   <content type="html">
&lt;p&gt;&lt;code&gt;.li&lt;/code&gt; is the ccTLD(Internet country code top-level domain) for Liechtenstein. I first saw this domain is at &lt;a href=&quot;http://www.iisp.com&quot;&gt;iisp.com&lt;/a&gt;. The price is pretty high(about $40/year) and made me give up.&lt;/p&gt;

&lt;p&gt;It so happened that this domain is also sold at &lt;a href=&quot;http://www.namecheap.com&quot;&gt;namecheap&lt;/a&gt; with 14.99$/year. According to the significance of this domain to me and such a low price, I bought it with no second thought.&lt;/p&gt;

&lt;p&gt;BTW, I also set up a custom email with this domain, &lt;a href=&quot;&amp;#109;&amp;#097;&amp;#105;&amp;#108;&amp;#116;&amp;#111;:&amp;#105;&amp;#064;&amp;#106;&amp;#105;&amp;#110;&amp;#103;&amp;#098;&amp;#101;&amp;#105;&amp;#046;&amp;#108;&amp;#105;&quot;&gt;&amp;#105;&amp;#064;&amp;#106;&amp;#105;&amp;#110;&amp;#103;&amp;#098;&amp;#101;&amp;#105;&amp;#046;&amp;#108;&amp;#105;&lt;/a&gt;. But my old main email account seems to need a long time to fade out.&lt;/p&gt;

&lt;p&gt;The next step is to build a site shortening urls using &lt;a href=&quot;http://yourls.org/&quot;&gt;YOURLS&lt;/a&gt;. But I have to wait the DNS synchronization for a while.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>A simple bat script to splicing videos</title>
   <link href="http://jingbei.li/2015/01/23/a-simple-bat-script-to-splicing-videos"/>
   <updated>2015-01-23T00:00:00+08:00</updated>
   <id>http://jingbei.li/2015/01/23/a-simple-bat-script-to-splicing-videos</id>
   <content type="html">
&lt;p&gt;Well, actually it’s a task given by my uncle. So the spirit of this script should be KISS, “Keep It Simple, Stupid”.&lt;/p&gt;

&lt;p&gt;Instead of GUI, I choose ffmpeg to be the decoder(and the encoder if necessary). Luckily, ffmpeg has a &lt;a href=&quot;http://ffmpeg.zeranoe.com/builds/&quot;&gt;static windows binary build&lt;/a&gt;. A good start!&lt;/p&gt;

&lt;p&gt;The next part is writing a KISS script for windows. Because I’m not familiar to bat files at all, it took a while before I finally found out a trick to solve a problem about processing the files’ name.&lt;/p&gt;

&lt;p&gt;The final version of the script looks like the following:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bat&quot; data-lang=&quot;bat&quot;&gt;&lt;span class=&quot;p&quot;&gt;@&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;off&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;/d&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;%~dp0&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ffmpeg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bin\ffmpeg.exe
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; filelist.txt
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; splicing.mkv
&lt;span class=&quot;nl&quot;&gt;:LOOP&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;IF&lt;/span&gt; [&lt;span class=&quot;nv&quot;&gt;%1&lt;/span&gt;]&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;[] &lt;span class=&quot;k&quot;&gt;GOTO&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;END&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;%1&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; file ^&lt;span class=&quot;s1&quot;&gt;&amp;#39;%~1^&amp;#39;&lt;/span&gt; &amp;gt;&lt;span class=&quot;p&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filelist&lt;/span&gt;.txt 
	&lt;span class=&quot;k&quot;&gt;SHIFT&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;GOTO&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;LOOP&lt;/span&gt;
&lt;span class=&quot;nl&quot;&gt;:END&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;%ffmpeg%&lt;/span&gt; -f concat -i filelist.txt -c copy splicing.mkv
rename splicing.mkv spliced.mkv
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; filelist.txt&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The trick is using &lt;code&gt;%~1&lt;/code&gt; to remove the &lt;code&gt;&quot;&lt;/code&gt; around the strings with spaces. Then force adding &lt;code&gt;&#39;&lt;/code&gt; around all the filenames or else the &lt;code&gt;\&lt;/code&gt; will be escaped.&lt;/p&gt;

&lt;p&gt;The usage of this script is quite simple. Make sure &lt;code&gt;bin\ffmpeg.exe&lt;/code&gt; exist then drag all the videos to the script file.&lt;br /&gt;
By default, it will not recode the videos to increase efficiency. If it goes wrong, such as splicing videos with different sizes, or the videos need to recode, just edit the ffmpeg command to fix it.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>A colorful byobu script to notify your new mails and feeds</title>
   <link href="http://jingbei.li/2015/01/09/a-simple-byobu-script-to-notify-your-new-mails-and-feeds"/>
   <updated>2015-01-09T00:00:00+08:00</updated>
   <id>http://jingbei.li/2015/01/09/a-simple-byobu-script-to-notify-your-new-mails-and-feeds</id>
   <content type="html">
&lt;p&gt;After &lt;a href=&quot;../../../../2014/12/29/using-rssdrop-to-read-feeds-in-mutt/&quot;&gt;delivering all the feeds to Maildirs by rssdrop&lt;/a&gt;, I also need a notification daemon in my byobu shell.&lt;/p&gt;

&lt;p&gt;Byobu supports custom script and display the outputs in the bottom bar. And particularly, you can &lt;a href=&quot;../../../../2014/11/11/show-colors-in-byobu-control-bar/&quot;&gt;use colors in byobu script’s output&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://7sbplw.com1.z0.glb.clouddn.com/screenshot-20150109_155440.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here is my notification script at &lt;code&gt;~/.byobu/bin/5_mail&lt;/code&gt;. 5 means checking every 5 seconds. Byobu will force all the scripts those period is shorter than 5 seconds to run as 5.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh -e&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;MAILDIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/$USER/Mail/Yahoo/Inbox&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;LOCK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/$USER/桌面/新邮件.desktop&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;LOCKFILE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/home/$USER/.byobu/bin/新邮件.desktop&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;MSGICON&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/usr/share/icons/Faenza/apps/scalable/gmail.svg&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;ICON_MAIL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;[新邮件!]&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;COLOR_SET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;#[fg=red bg=white bold]&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;COLOR_RESTORE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;#[fg=$BYOBU_LIGHT bg=$BYOBU_DARK]&amp;quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;`ls $MAILDIR/new`&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$COLOR_SET&amp;quot;&amp;quot;$ICON_MAIL&amp;quot;&amp;quot;$COLOR_RESTORE&amp;quot;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! -f &lt;span class=&quot;nv&quot;&gt;$LOCK&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
		cp &lt;span class=&quot;nv&quot;&gt;$LOCKFILE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$LOCK&lt;/span&gt;
		notify-send -i &lt;span class=&quot;nv&quot;&gt;$MSGICON&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;新邮件&amp;quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ICON_MAIL&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
	rm -f &lt;span class=&quot;nv&quot;&gt;$LOCK&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/&lt;span class=&quot;nv&quot;&gt;$USER&lt;/span&gt;/Mail/rss/
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; i in *
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;`ls $i/new`&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
		&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$COLOR_SET&amp;quot;&amp;quot;[$i]&amp;quot;&amp;quot;$COLOR_RESTORE&amp;quot;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</content>
 </entry>
 
 <entry>
   <title>Using rssdrop to receive and read feeds in Mutt</title>
   <link href="http://jingbei.li/2014/12/29/using-rssdrop-to-read-feeds-in-mutt"/>
   <updated>2014-12-29T00:00:00+08:00</updated>
   <id>http://jingbei.li/2014/12/29/using-rssdrop-to-read-feeds-in-mutt</id>
   <content type="html">
&lt;h3 id=&quot;rssdrop&quot;&gt;rssdrop&lt;/h3&gt;

&lt;p&gt;rssdrop is a perl script to deliver feeds to Maildirs. The &lt;a href=&quot;http://search.cpan.org/~acg/rssdrop/&quot;&gt;origin script&lt;/a&gt; is out of date and very buggy. So I create a &lt;a href=&quot;https://github.com/petronny/rssdrop&quot;&gt;fork&lt;/a&gt; and fixed lots of problems.&lt;/p&gt;

&lt;h4 id=&quot;install&quot;&gt;Install&lt;/h4&gt;

&lt;p&gt;The dependencies are &lt;code&gt;perl-xml-simple&lt;/code&gt;, &lt;code&gt;perl-date-manip&lt;/code&gt; and &lt;code&gt;perl-lwp-protocol-https&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If you have solved the dependencies, clone my fork and rssdrop just works:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone https://github.com/petronny/rssdrop
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you are using Archlinux, just install the &lt;code&gt;rssdrop&lt;/code&gt; package from AUR.&lt;/p&gt;

&lt;h4 id=&quot;getting-start&quot;&gt;Getting start&lt;/h4&gt;

&lt;h5 id=&quot;initialize-rssdrop&quot;&gt;Initialize rssdrop&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;$ rssdrop --mailfolder path/to/mailfolder
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&quot;subscribe-to-a-new-feed&quot;&gt;Subscribe to a new feed&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;$ rssdrop -a archlinux https://www.archlinux.org/feeds/news/
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&quot;fetch-items-in-your-new-feed&quot;&gt;Fetch items in your new feed&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;$ rssdrop archlinux
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&quot;unsubscribe&quot;&gt;Unsubscribe&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;$ rssdrop -d archlinux
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&quot;fetch-all-new-items-in-all-feeds&quot;&gt;Fetch all new items in all feeds&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;$ rssdrop
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;mutt&quot;&gt;Mutt&lt;/h3&gt;

&lt;p&gt;This part is simple, you can navigate to your feeds maildir or add it to spoolfile in your &lt;code&gt;.muttrc&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;But almost all the feed contents are html files, mutt will show them in plain text as default.
It’s not quite human readable so you need a &lt;code&gt;html2txt&lt;/code&gt; script to convert it.&lt;/p&gt;

&lt;h3 id=&quot;html2txt&quot;&gt;html2txt&lt;/h3&gt;

&lt;p&gt;Refer to &lt;a href=&quot;http://stromberg.dnsalias.org/~strombrg/mutt-html.html&quot;&gt;this blog&lt;/a&gt;, &lt;code&gt;links&lt;/code&gt; is a good choice because of its numbered links feature. I changed it to &lt;code&gt;elinks&lt;/code&gt; for Chinese supporting. Make sure it’s executable, and on your &lt;code&gt;$PATH&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Here is an example of &lt;code&gt;html2txt&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# for mutt to view html e-mails&lt;/span&gt;

elinks -dump &lt;span class=&quot;s2&quot;&gt;&amp;quot;file://$@&amp;quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#or&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#lynx -force_html -dump &amp;quot;$@&amp;quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#or&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#w3m -T text/html -F -dump &amp;quot;$@&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;You also need a &lt;code&gt;~/.mailcap&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# for mutt to view html e-mails
text/html;html2txt %s; copiousoutput
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And configure the following options in your &lt;code&gt;~/.muttrc&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# for viewing html e-mails inside mutt.  See also .mailcap
auto_view text/html
alternative_order text/enriched text/plain text text/html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you can read all the html mails in mutt, not only the feeds.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Auto convert the base64 code in Abook</title>
   <link href="http://jingbei.li/2014/12/17/auto-convert-the-base64-code-into-utf-8"/>
   <updated>2014-12-17T00:00:00+08:00</updated>
   <id>http://jingbei.li/2014/12/17/auto-convert-the-base64-code-into-utf-8</id>
   <content type="html">&lt;p&gt;&lt;a href=&quot;http://abook.sourceforge.net/&quot;&gt;Abook&lt;/a&gt; is a text-based addressbook program designed to use with &lt;a href=&quot;http://www.mutt.org/&quot;&gt;mutt&lt;/a&gt; mail client.&lt;/p&gt;

&lt;p&gt;There is a chapter about using abook with mutt in the &lt;a href=&quot;https://wiki.archlinux.org/index.php/Mutt#Abook&quot;&gt;ArchWiki&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you want to use &lt;strong&gt;Abook&lt;/strong&gt; instead of aliases, remove the aliases configuration in &lt;code&gt;.muttrc&lt;/code&gt; and add this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set query_command= &quot;abook --mutt-query &#39;%s&#39;&quot;
macro index,pager  a &quot;&amp;lt;pipe-message&amp;gt;abook --add-email-quiet&amp;lt;return&amp;gt;&quot; &quot;Add this sender to Abook&quot;
bind editor        &amp;lt;Tab&amp;gt; complete-query
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But sadly, the command &lt;code&gt;abook --add-email-quiet&lt;/code&gt; always gets names like “=?utf-8?B?55m+5ZCI5LuZ5a2Q?=” which is base64 encoded.&lt;/p&gt;

&lt;p&gt;To convert the base64 string and automatically fit the correct encoding, you can use a shell function:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;conv&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; awk -F &lt;span class=&quot;s1&quot;&gt;&amp;#39;?&amp;#39;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;{ print &amp;quot;echo &amp;quot; $4 &amp;quot; | base64 -d | iconv -f &amp;quot; $2 }&amp;#39;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ conv name==?utf-8?B?55m+5ZCI5LuZ5a2Q?=
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or a python script like this:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cython&quot; data-lang=&quot;cython&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/env python2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.header&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;abookdecode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;origin_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;infile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readlines&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;infile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	    &lt;span class=&quot;n&quot;&gt;outfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abookdecode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;outfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And then change your &lt;code&gt;.muttrc&lt;/code&gt; to call the script:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;macro index,pager  a &quot;&amp;lt;pipe-message&amp;gt;abook --add-email-quiet &amp;amp;&amp;amp; abook-decode ~/.abook/addressbook&amp;lt;return&amp;gt;&quot; &quot;Add this sender to Abook&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now the addressbook will be written correctly.&lt;/p&gt;

</content>
 </entry>
 
 <entry>
   <title>A simple script to check your ruby library version</title>
   <link href="http://jingbei.li/2014/11/29/a-simple-script-to-check-your-ruby-version"/>
   <updated>2014-11-29T00:00:00+08:00</updated>
   <id>http://jingbei.li/2014/11/29/a-simple-script-to-check-your-ruby-version</id>
   <content type="html">
&lt;p&gt;Most ruby packages are not maintained by the Archlinux repository, I installed them locally then added &lt;code&gt;~/.gem/ruby/2.1.0/bin&lt;/code&gt; to &lt;code&gt;$PATH&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Although the ruby version is &lt;code&gt;2.1.5&lt;/code&gt;, it uses &lt;code&gt;2.1.0&lt;/code&gt; as the library version. It feels silly if I change it manually every time, so I have to find a way to check it automatically.&lt;/p&gt;

&lt;p&gt;Refer to this &lt;a href=&quot;http://forum.ubuntu.com.cn/viewtopic.php?f=48&amp;amp;t=466400&quot;&gt;post&lt;/a&gt;, the output of &lt;code&gt;ruby -e &#39;puts $LOAD_PATH&#39;&lt;/code&gt; includes what I need.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;/usr/lib/ruby/site_ruby/2.2.0
/usr/lib/ruby/site_ruby/2.2.0/x86_64-linux
/usr/lib/ruby/site_ruby
/usr/lib/ruby/vendor_ruby/2.2.0
/usr/lib/ruby/vendor_ruby/2.2.0/x86_64-linux
/usr/lib/ruby/vendor_ruby
/usr/lib/ruby/2.2.0
/usr/lib/ruby/2.2.0/x86_64-linux&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then use &lt;code&gt;sed&lt;/code&gt; and &lt;code&gt;grep&lt;/code&gt; to find it out.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;ruby -e &lt;span class=&quot;s1&quot;&gt;&amp;#39;puts $LOAD_PATH&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sed &lt;span class=&quot;s2&quot;&gt;&amp;quot;s/\/usr\/lib\/ruby\///g&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;grep &lt;span class=&quot;s1&quot;&gt;&amp;#39;^[0-9\.]*$&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Finally I added the following line to &lt;code&gt;.zshrc&lt;/code&gt; and it works fine.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;nv&quot;&gt;ruby_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;ruby -e &lt;span class=&quot;s1&quot;&gt;&amp;#39;puts $LOAD_PATH&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sed &lt;span class=&quot;s2&quot;&gt;&amp;quot;s/\/usr\/lib\/ruby\///g&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;grep &lt;span class=&quot;s1&quot;&gt;&amp;#39;^[0-9\.]*$&amp;#39;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt; ~/.gem/ruby/&lt;span class=&quot;nv&quot;&gt;$ruby_version&lt;/span&gt;/bin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;BTW, this script can also be used in the PKGBUILD of ruby gem packages.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Showing colors in the Byobu custom scripts</title>
   <link href="http://jingbei.li/2014/11/11/show-colors-in-byobu-control-bar"/>
   <updated>2014-11-11T00:00:00+08:00</updated>
   <id>http://jingbei.li/2014/11/11/show-colors-in-byobu-control-bar</id>
   <content type="html">
&lt;p&gt;&lt;a href=&quot;byobu.co&quot;&gt;Byobu&lt;/a&gt; is a frontend for screen or tmux.&lt;/p&gt;

&lt;p&gt;But the custom script sample in the manual page does not working in tmux.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;\005{= bw}%s\005{-}\n&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$(uname -r)&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Actually, writing it in tmux’s way is ok.&lt;/p&gt;

&lt;p&gt;Here is an example for showing the Wifi name with colors.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-sh&quot; data-lang=&quot;sh&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh -e&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;COLOR_SET&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;#[fg=white bg=blue bold]&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;COLOR_RESTORE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;#[fg=$BYOBU_LIGHT bg=$BYOBU_DARK]&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;iwconfig &lt;span class=&quot;nv&quot;&gt;$MONITORED_NETWORK&lt;/span&gt; 2&amp;gt;/dev/null &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; awk &lt;span class=&quot;s1&quot;&gt;&amp;#39;$0 ~ /[ ]*SSID/ { sub(/.*[:]/,&amp;quot;&amp;quot;,$4); printf(&amp;quot;ssid=%s\n&amp;quot;, $4); }&amp;#39;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$out&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;$ssid&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;off/any&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
	&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; -e &lt;span class=&quot;s2&quot;&gt;&amp;quot;$COLOR_SET&amp;quot;&amp;quot;$ssid&amp;quot;&amp;quot;$COLOR_RESTORE&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</content>
 </entry>
 
 <entry>
   <title>Running QQDownload prefectly under linux</title>
   <link href="http://jingbei.li/2014/10/21/running-qqdownload-prefectly-under-linux"/>
   <updated>2014-10-21T00:00:00+08:00</updated>
   <id>http://jingbei.li/2014/10/21/running-qqdownload-prefectly-under-linux</id>
   <content type="html">
&lt;p&gt;&lt;a href=&quot;http://xf.qq.com/index.html&quot;&gt;QQDownload&lt;/a&gt;(QQ旋风, which means “QQ tornado”) is a download manager and bittorrent client developed by Tencent Holdings Ltd.&lt;/p&gt;

&lt;p&gt;Comparing with its main competitor, Xunlei, QQDownload is more easier to handle by wine.&lt;/p&gt;

&lt;p&gt;Here is a tutorial for running QQDownload 4.8 Beta using wine:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Create a new 32-bit wineprefix&lt;/p&gt;

    &lt;p&gt;export WINEARCH=win32
 export WINEPREFIX=somewhere winetricks&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;If wine ask you to install &lt;code&gt;gecko&lt;/code&gt; and &lt;code&gt;mono&lt;/code&gt; plugins, permit it.&lt;/li&gt;
  &lt;li&gt;Install &lt;code&gt;windowscodecs&lt;/code&gt; to your wineprefix using &lt;code&gt;winetricks&lt;/code&gt; GUI.&lt;/li&gt;
  &lt;li&gt;Then install &lt;code&gt;riched20&lt;/code&gt;, &lt;code&gt;riched30&lt;/code&gt; and &lt;code&gt;wininet&lt;/code&gt; to your wineprefix using &lt;code&gt;winetricks&lt;/code&gt; GUI.&lt;/li&gt;
  &lt;li&gt;Finally you need a Chinese font for all charactors. The &lt;code&gt;fakeChinese&lt;/code&gt; in &lt;code&gt;winetricks&lt;/code&gt; is a good choice.&lt;/li&gt;
  &lt;li&gt;Have fun! You may need a desktop launcher.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ps&quot;&gt;PS&lt;/h3&gt;

&lt;p&gt;if you have permission to use the &lt;a href=&quot;http://lixian.qq.com/login.html&quot;&gt;Tencent offline downloading&lt;/a&gt;, 
such as VIP account or gained LV8 in QQDownload, I recommend you to try out another python script, &lt;a href=&quot;https://github.com/kikyous/xfdown&quot;&gt;xfdown&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Xfdown now has a awesome Tui with color support, wow.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Using astyle to format C/C++ codes</title>
   <link href="http://jingbei.li/2013/12/14/using-astyle-to-format-cc-codes"/>
   <updated>2013-12-14T00:00:00+08:00</updated>
   <id>http://jingbei.li/2013/12/14/using-astyle-to-format-cc-codes</id>
   <content type="html">
&lt;pre&gt;&lt;code&gt;astyle *.hpp -A7tCSKNLwYFpPHxdk2W2yej
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here is a preview.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span class=&quot;cp&quot;&gt;#ifndef __Hero_Bazzi__&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#define __Hero_Bazzi__&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &amp;quot;cocos2d.h&amp;quot;&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#include &amp;quot;HeroClass.hpp&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;USING_NS_CC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HeroBazzi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Hero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;createhero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CCPoint&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HeroBazzi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createhero&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CCPoint&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;speed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;direction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bubble_range&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;bubble_num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sca&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;islive&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;isfree&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sprite&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CCSprite&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sprite&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setScale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sprite&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setPosition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;AniReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;unit_bazzi.ani&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;AniReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;unit_luxbazzi.ani&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AniReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AniReader&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
		&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;  &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;texture&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CCTextureCache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sharedTextureCache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;image/unit/unit_bazzi.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;texture&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CCTextureCache&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sharedTextureCache&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;addImage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;image/unit/unit_luxbazzi.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;animate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CCRepeatForever&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CCAnimate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;moveanimation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)));&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;sprite&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;runAction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;animate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;#endif&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</content>
 </entry>
 
 <entry>
   <title>Using gtest and gcov in cocos2dx</title>
   <link href="http://jingbei.li/2013/12/14/cocos2dxgtestgcov"/>
   <updated>2013-12-14T00:00:00+08:00</updated>
   <id>http://jingbei.li/2013/12/14/cocos2dxgtestgcov</id>
   <content type="html">
&lt;p&gt;狂调半宿代码，深感与硬件打交道坑爹之处．
现暂记几处，以免后人入坑．&lt;/p&gt;

&lt;h3 id=&quot;cocos2dxlibtiffamain&quot;&gt;cocos2dx的libtiff.a的main函数重定义&lt;/h3&gt;

&lt;p&gt;这样自己写的c文件都不能有main函数，gtest和gcov都不能用了.
&lt;a href=&quot;http://blog.linguofeng.com/archive/2013/04/17/cocos2d-x-ndkgdb.html&quot;&gt;参见此贴&lt;/a&gt; 
后简直雪中送炭．&lt;/p&gt;

&lt;p&gt;现把我在自己的项目中的做法记下来：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;切换到UnitTest分支&lt;/li&gt;
  &lt;li&gt;做git下的proj.android/exteral到cocos2dx/sebomber/proj.android/exteral的软连接&lt;/li&gt;
  &lt;li&gt;用git下的libtiff.a替换 cocos2d-x-2.1.5/cocos2dx/platform/third_party/android/prebuilt/libtiff/libs/armeabi/libtiff.a&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;jnimain3cppgtest&quot;&gt;在jni/main3.cpp内做gtest单元测试&lt;/h4&gt;

&lt;p&gt;编译使用原来的编译方式&lt;/p&gt;

&lt;p&gt;运行方式&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;adb push cocos2d-x-2.1.5/sebomber/proj.android/libs/armeabi/libgame /data/
adb shell
export GCOV_PREFIX=/sdcard/mycov
cd /data
./libgame
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
  &lt;li&gt;运行结束后，生成的GCOV用的文件在/sdcard/mycov里&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&quot;gcovhome&quot;&gt;获取GCOV文件到home&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;adb pull /sdcard/mycov ~
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;将cocos2d-x-2.1.5/sebomber/proj.android/obj里面的.gcno文件
从手机里得到的.gcda, 和对应的.cpp文件放在一起
运行&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;android-ndk/toolchains/arm-linux-androideabi-4.6/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcov -b *.cpp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;即可得到覆盖率报告及生成的报告文件&lt;/p&gt;

&lt;p&gt;其中，libtiff.a是要自己重编译的．里面的libgtest也要重编译．&lt;/p&gt;

&lt;h3 id=&quot;gtestcocos2dx&quot;&gt;gtest与cocos2dx冲突的问题&lt;/h3&gt;

&lt;p&gt;感谢&lt;a href=&quot;https://github.com/sfuku7/googletest_android_ndk-build&quot;&gt;github.com/sfuku7/googletest_android_ndk-build&lt;/a&gt;
给出了详尽的使用方式．&lt;/p&gt;

&lt;p&gt;不过里面自带的那个libgtest是不能直接用的．
由于cocos2dx在编译时使用了frtti优化，我在写cocos2dx项目的单元测试文件时要么gtest不能用，要么cocos2dx不能用．
蛋疼了好几个小时，饭都没吃．最后想到把libgtest也开启frtti重编译一下就应该兼容了．&lt;/p&gt;

&lt;p&gt;还是按照上面那个链接里面给出的googletest的编译方式
额外在googletest的jni/Application.mk中添加&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;APP_CPPFLAGS := -frtti
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;然后做一个新的libgtest.&lt;/p&gt;

&lt;p&gt;放到那个项目的sample/test_project/external下对应的地方测试能用．&lt;/p&gt;

&lt;p&gt;按照sample/test_project/下的目录结构复制到cocos2dx的proj.android下，终于成功了．&lt;/p&gt;
</content>
 </entry>
 
 
</feed>
